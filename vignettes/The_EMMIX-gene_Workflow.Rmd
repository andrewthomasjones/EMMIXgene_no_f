---
title: "EMMIX-gene"
author: "Andrew Jones"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
bibliography: bibliography.bib
vignette: >
  %\VignetteIndexEntry{EMMIX-gene}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

# EMMIX-gene 
The aim of this document is to reproduce the results of the original EMMIX-gene paper (@mclachlan2002mixture) while demonstrating the EMMIX-gene R-package workflow.


## Data
The original paper analysed two data sets. These are included in the R-package. 

golub_data is a dataset containing the centred and normalised values of the logged expression values of a subset of 3731 genes taken from @golub1999molecular.

alon_data is a dataset containing the centred and normalised values of the logged expression values of a subset of 2000 genes taken from @alon1999broad.

The method of subset selection for both datasets follows that of their original papers and is described in @mclachlan2002mixture.

```{r}
library(EMMIXgene)
data(alon_data)
dim(alon_data)
data(golub_data)
dim(golub_data)

```

## Single Genes

```{r, fig.show='hold'}
plot_single_gene(alon_data,1758) 
plot_single_gene(alon_data,474,g=3) 
```

```{r, fig.show='hold'}
plot_single_gene(alon_data, 474, g=2) 
```

## Select Genes
```{r}
#5.1
alon_sel<-select_genes(alon_data)
n_alon<-sum(alon_sel$selected)
```

<!-- #5.1.1 -->
<!-- alon_top<-top_genes_cluster_tissues(alon_sel, n_alon, k=6) -->
<!-- alon_top_50<-top_genes_cluster_tissues(alon_sel, 50, k=6) -->

<!-- heat_maps(alon_sel$all_genes[alon_top$top_genes,], alon_top$clustering) -->
<!-- heat_maps(alon_sel$all_genes[alon_top_50$top_genes,], alon_top_50$clustering) -->


<!-- #5.1.2 -->
<!-- alon_clus_20<-cluster_genes(alon_sel2, 10) -->
<!-- alon_clus_20_t<-cluster_tissues(alon_sel, alon_clus_20, method='t', q=4) -->

<!-- for(j in 1:10){ -->
<!--   plot<-heat_maps(alon_sel$genes[alon_clus_20$classification==j,], alon_clus_20_t[j,])  -->
<!--   print(plot) -->
<!-- } -->

<!-- golub_sel<-select_genes(golub_data) -->
<!-- golub_sel2<-select_genes(dat=golub_data, random_starts=8, max_it = 100, ll_thresh = 8, min_clust_size = 8, tol = 0.00001, start_method ="kmeans", three = T) -->

<!-- #5.2 -->
<!-- golub_clus_g<-cluster_genes(golub_sel) -->
<!-- n_golub<-sum(golub_sel2$selected) -->

<!-- golub_clus_40<-cluster_genes(golub_sel2, 20) -->
<!-- golub_clus_40_t<-cluster_tissues(golub_sel2, golub_clus_40, method='t', q=8) -->

<!-- golub_top_50<-top_genes_cluster_tissues(golub_sel2, 50, q=6) -->


<!-- heat_maps(golub_sel$all_genes[golub_top_50$top_genes,], golub_top_50$clustering) -->

<!-- for(j in 1:10){ -->
<!--   plot<-heat_maps(golub_sel2$genes[golub_clus_40$classification==j,], golub_clus_40_t[j,])  -->
<!--   print(plot) -->
<!-- } -->


<!-- golub_top_50<-top_genes_cluster_tissues(golub_sel2, 50, q=6, g=2) -->



# References