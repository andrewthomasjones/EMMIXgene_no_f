---
title: "EMMIX-gene"
author: "Andrew Jones"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
bibliography: bibliography.bib
vignette: >
    %\VignetteIndexEntry{EMMIX-gene}
    %\VignetteEngine{knitr::rmarkdown}
    %\VignetteEncoding{UTF-8}
---

# EMMIX-gene 
The aim of this document is to reproduce the results of the original EMMIX-gene paper (@mclachlan2002mixture) while demonstrating the EMMIX-gene R-package workflow.


## Data
The original paper analysed two data sets. These are included in the R-package. 

golub_data is a dataset containing the centred and normalised values of the logged expression values of a subset of 3731 genes taken from @golub1999molecular.

alon_data is a dataset containing the centred and normalised values of the logged expression values of a subset of 2000 genes taken from @alon1999broad.

The method of subset selection for both datasets follows that of their original papers and is described in @mclachlan2002mixture.

```{r}
library(EMMIXgene)
data(Golub_Merge)
data(colonCA)
```

## Single Genes

```{r, fig.show='hold', cache=T}
plot_single_gene(alon_data,201)
plot_single_gene(alon_data,202,g=3)
```

```{r, fig.show='hold', cache=T}
plot_single_gene(alon_data, 202, g=2)
```

## Select Genes
```{r, echo=F, cache=TRUE}
alon_sel<-select_genes(alon_data)
n_alon<-sum(alon_sel$selected)
```

```{r, fig.show='hold', echo=FALSE, results='hide', cache=TRUE, message='hide'}
alon_top_n<-top_genes_cluster_tissues(alon_sel, n_alon, method='mfa', q=6, g=2)
heat_maps(alon_sel$all_genes[alon_top_n$top_genes,], alon_top_n$clustering)
cat(c("C1: ", c(which(alon_top_n$clustering==1)),"\n"))
cat(c("C2: ", c(which(alon_top_n$clustering==0)),"\n"))
```


```{r, fig.show='hold', echo=FALSE, results='hide', cache=TRUE, message='hide'}
alon_top_50<-top_genes_cluster_tissues(alon_sel, 12, method='mfa', q=6, g=2)
heat_maps(alon_sel$all_genes[alon_top_50$top_genes,], alon_top_50$clustering)
cat(c("C1: ", paste(which(alon_top_50$clustering==1)),"\n"))
cat(c("C2: ", paste(which(alon_top_50$clustering==0)),"\n"))
```


#5.1.2
```{r, echo=F,  cache=TRUE,message='hide'}
groups<-4
alon_clus_5 <- cluster_genes(alon_sel, groups)
alon_clus_5_t1<-all_cluster_tissues(gen=alon_sel, clusters=alon_clus_5, q=3, G=2)
alon_clus_5_t2<-cluster_tissues(alon_sel, alon_clus_5, method='t')
alon_clus_5_t3<-cluster_tissues(alon_sel, alon_clus_5, method='mfa', q=2, G=2)
cat(c("C1: ", paste(which(alon_clus_5_t1==1)),"\n"))
cat(c("C2: ", paste(which(alon_clus_5_t1==0)),"\n"))

```


```{r, echo=F, fig.show='hold'}
j=1
plot<-heat_maps(alon_sel$genes[alon_clus_5==j,], alon_clus_5_t3[j,], paste0("Genes from Group G",j))
print(plot)
cat(c("C1: ", paste(which(alon_clus_5_t3[j,]==1)),"\n"))
cat(c("C2: ", paste(which(alon_clus_5_t3[j,]==0)),"\n"))
```

```{r, echo=F, fig.show='hold'}
j=2
plot<-heat_maps(alon_sel$genes[alon_clus_5==j,], alon_clus_5_t3[j,], paste0("Genes from Group G",j))
print(plot)
cat(c("C1: ", paste(which(alon_clus_5_t3[j,]==1)),"\n"))
cat(c("C2: ", paste(which(alon_clus_5_t3[j,]==0)),"\n"))
```

```{r, echo=F, fig.show='hold'}
j=3
plot<-heat_maps(alon_sel$genes[alon_clus_5==j,], alon_clus_5_t3[j,], paste0("Genes from Group G",j))
print(plot)
cat(c("C1: ", paste(which(alon_clus_5_t3[j,]==1)),"\n"))
cat(c("C2: ", paste(which(alon_clus_5_t3[j,]==0)),"\n"))
```


```{r, echo=F, fig.show='hold'}
j=4
plot<-heat_maps(alon_sel$genes[alon_clus_5==j,], alon_clus_5_t3[j,], paste0("Genes from Group G",j))
print(plot)
cat(c("C1: ", paste(which(alon_clus_5_t3[j,]==1)),"\n"))
cat(c("C2: ", paste(which(alon_clus_5_t3[j,]==0)),"\n"))
```


5.1.3
```{r, echo=F,  cache=TRUE, message='hide'}
cat(c("C1: ", paste(which(alon_clus_5_t1==1)),"\n"))
cat(c("C2: ", paste(which(alon_clus_5_t1==0)),"\n"))
```



## Select Genes
```{r, cache=TRUE}
golub_sel<-select_genes(golub_data)
```



```{r, echo=F,  cache=TRUE,message='hide'}
groups<-5
golub_clus_10 <- cluster_genes(golub_sel, groups)
golub_clus_10_t1<-all_cluster_tissues(gen=golub_sel, clusters=golub_clus_10, q=3, G=2)
golub_clus_10_t2<-cluster_tissues(golub_sel, golub_clus_10, method='t')
golub_clus_10_t3<-cluster_tissues(golub_sel, golub_clus_10, method='mfa', q=2)
```


```{r, echo=F, fig.show='hold'}
j=1
plot<-heat_maps(golub_sel$genes[golub_clus_10==j,], golub_clus_10_t3[j,], paste0("Genes from Group G",j))
print(plot)
cat(c("C1: ", paste(which(golub_clus_10_t3[j,]==1)),"\n"))
cat(c("C2: ", paste(which(golub_clus_10_t3[j,]==0)),"\n"))
```

```{r, echo=F, fig.show='hold'}
j=2
plot<-heat_maps(golub_sel$genes[golub_clus_10==j,], golub_clus_10_t3[j,], paste0("Genes from Group G",j))
print(plot)
cat(c("C1: ", paste(which(golub_clus_10_t3[j,]==1)),"\n"))
cat(c("C2: ", paste(which(golub_clus_10_t3[j,]==0)),"\n"))
```

```{r, echo=F, fig.show='hold'}
j=3
plot<-heat_maps(golub_sel$genes[golub_clus_10==j,], golub_clus_10_t3[j,], paste0("Genes from Group G",j))
print(plot)
cat(c("C1: ", paste(which(golub_clus_10_t3[j,]==1)),"\n"))
cat(c("C2: ", paste(which(golub_clus_10_t3[j,]==0)),"\n"))
```


```{r, echo=F,cache=TRUE, message='hide'}
groups<-10
golub_clus_10 <- cluster_genes(golub_sel, groups)
golub_clus_10_t1<-all_cluster_tissues(gen=golub_sel, clusters=golub_clus_10, q=5, G=2)
golub_clus_10_t2<-cluster_tissues(golub_sel, golub_clus_10, method='t')
golub_clus_10_t3<-all_cluster_tissues(gen=golub_sel, clusters=golub_clus_10, q=3, G=3)
```


```{r, echo=F, fig.show='hold'}
cat(c("C1: ", paste(which(golub_clus_10_t1==1)),"\n"))
cat(c("C2: ", paste(which(golub_clus_10_t1==0)),"\n"))
```

```{r, echo=F, results='hide', fig.show='hold'}
golub_top_50<-top_genes_cluster_tissues(golub_sel, 50, method='mfa', q=8, g=2)
heat_maps(golub_sel$all_genes[golub_top_50$top_genes,], golub_top_50$clustering)
cat(c("C1: ", paste(which(golub_top_50$clustering==0)),"\n"))
cat(c("C2: ", paste(which(golub_top_50$clustering==1)),"\n"))

```

```{r, echo=F, fig.show='hold'}
cat(c("C1: ", paste(which(golub_clus_10_t3==0)),"\n"))
cat(c("C2: ", paste(which(golub_clus_10_t3==1)),"\n"))
cat(c("C3: ", paste(which(golub_clus_10_t3==2)),"\n"))
```


# References